(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3157:(e,t,a)=>{Promise.resolve().then(a.bind(a,1169))},728:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(5974);let s="https://ejffrphknvtsmntlqwtp.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZmZycGhrbnZ0c21udGxxd3RwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDAzMTU2OTQsImV4cCI6MjA1NTg5MTY5NH0.HwMetNI_Y-osSsZJHe8pXGF1VIy7Jrf54MXcL4Q9XWQ";if(!s||!l)throw Error("Missing Supabase environment variables");let n=(0,r.UU)(s,l,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},1169:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a(5155),s=a(2115),l=a(728);function n(e){let{message:t,className:a=""}=e;return(0,r.jsx)("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg ".concat(a),children:(0,r.jsx)("p",{className:"text-sm",children:t})})}function o(){let[e,t]=(0,s.useState)(!1),[a,o]=(0,s.useState)(!1),[d,i]=(0,s.useState)(null),[c,g]=(0,s.useState)(null),x=(0,s.useRef)(null);return(0,s.useEffect)(()=>{t(!0);let e=0,a=()=>{var t,s;if(e>=3){g("Failed to load Google Sign In. Please refresh the page.");return}(null===(s=window.google)||void 0===s?void 0:null===(t=s.accounts)||void 0===t?void 0:t.id)?(o(!0),r()):(e++,setTimeout(a,1e3))},r=()=>{try{if(!x.current)return;window.oauth_callback=async function(e){try{let{error:t}=await l.A.auth.signInWithIdToken({provider:"google",token:e.credential});if(t)throw t}catch(e){i(e.message)}},window.google.accounts.id.initialize({client_id:"50413404459-vfhmo6k7hsil346h2jjct1m5jbuu2huj.apps.googleusercontent.com",callback:window.oauth_callback,auto_select:!0,context:"signin"}),window.google.accounts.id.renderButton(x.current,{type:"standard",theme:"outline",size:"large",text:"signin_with",shape:"rectangular",logo_alignment:"center"})}catch(e){i(e.message)}};a()},[]),(0,r.jsxs)("div",{className:"max-w-md mx-auto p-4 text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Daily Focus Tracker"}),(0,r.jsxs)("div",{className:"p-8 border rounded-lg shadow-lg",children:[(0,r.jsx)("h2",{className:"text-xl mb-4",children:"Please Sign In"}),d&&(0,r.jsx)(n,{message:d,className:"mb-4"}),c&&(0,r.jsx)(n,{message:c,className:"mb-4"}),(0,r.jsx)("div",{ref:x,className:"flex justify-center"}),!a&&e&&(0,r.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:"Loading sign in options..."})]})]})}var d=a(6472),i=a(9861),c=a(5781);function g(e){let{data:t,visibleLines:a}=e;if(!t||0===t.length)return(0,r.jsx)("div",{className:"w-full h-48 flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available"})});try{let e=t.map(e=>{var t;return null!==(t=e.strength_ratio)&&void 0!==t?t:0}),s=t.map(e=>{var t;return null!==(t=e.cardio_ratio)&&void 0!==t?t:0}),l=t.map(e=>{var t,a;if(null!=e.combined_ratio)return e.combined_ratio;let r=null!==(t=e.strength_ratio)&&void 0!==t?t:0,s=null!==(a=e.cardio_ratio)&&void 0!==a?a:0;return(r+s)/2}),n={labels:t.map(e=>e.workout_date),datasets:[{label:"Strength",data:e,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",hidden:!a.strength,borderWidth:1.5,pointRadius:0,tension:.3,borderOpacity:a.strength?1:.25},{label:"Cardio",data:s,borderColor:"rgb(234, 88, 12)",backgroundColor:"rgba(234, 88, 12, 0.1)",hidden:!a.cardio,borderWidth:1.5,pointRadius:0,tension:.3,borderOpacity:a.cardio?1:.25},{label:"Combined",data:l,borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",hidden:!a.combined,borderWidth:1.5,pointRadius:0,tension:.3,borderOpacity:a.combined?1:.25}]};return(0,r.jsx)("div",{className:"w-full h-48",children:(0,r.jsx)(d.N1,{data:n,options:{responsive:!0,scales:{y:{beginAtZero:!0,grid:{color:"rgba(156, 163, 175, 0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45}}},plugins:{legend:{display:!1},tooltip:{intersect:!1,mode:"index"},annotation:{annotations:{idealRange:{type:"box",yMin:.8,yMax:1.4,backgroundColor:"rgba(34, 197, 94, 0.1)",borderColor:"transparent"}}}},interaction:{intersect:!1,mode:"index"}}})})}catch(e){return console.error("Chart error:",e),(0,r.jsx)(n,{message:"Failed to load chart"})}}function x(e){let{label:t,value:a,isVisible:s,color:l,onClick:n}=e;return(0,r.jsxs)("button",{onClick:n,className:"flex items-center justify-between w-full p-2 rounded-lg transition-all ".concat(s?"bg-opacity-10 "+l:"bg-gray-100 dark:bg-gray-700"),children:[(0,r.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:t}),(0,r.jsx)("span",{className:"font-bold ".concat(s?a<.8?"text-yellow-500 dark:text-yellow-400":a<=1.4?"text-green-500 dark:text-green-400":"text-red-500 dark:text-red-400":"text-gray-400 dark:text-gray-500"),children:a.toFixed(2)})]})}c.t1.register(c.PP,c.kc,c.FN,c.No,c.hE,c.m_,c.s$,i.A);var u=a(1586);function m(){return(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4 cursor-help inline-flex items-center","data-tooltip-id":"load-ratios-tooltip","data-tooltip-html":'\n    <div class="text-sm">\n      <div class="font-semibold mb-2">Training Load Zones:</div>\n      <div class="space-y-2">\n        <div class="flex items-center">\n          <div class="inline-block w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>\n          <span>Below 0.8: Recovery/Undertraining Zone</span>\n        </div>\n        <div class="flex items-center">\n          <div class="inline-block w-3 h-3 rounded-full bg-green-500 mr-2"></div>\n          <span>0.8 - 1.4: Ideal Training Zone</span>\n        </div>\n        <div class="flex items-center">\n          <div class="inline-block w-3 h-3 rounded-full bg-red-500 mr-2"></div>\n          <span>Above 1.4: Overtraining Risk Zone</span>\n        </div>\n      </div>\n    </div>\n  ',"data-tooltip-delay-show":500,children:["Load Ratios",(0,r.jsx)("span",{className:"ml-1 text-gray-400 text-sm",children:"ⓘ"})]}),(0,r.jsx)(u.m_,{id:"load-ratios-tooltip",place:"top",className:"max-w-xs !bg-white !text-gray-800 !opacity-100",classNameArrow:"!border-white"})]})}function h(e){let{isOpen:t,onClose:a,isSaving:s,error:l}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl max-w-4xl w-full m-4 shadow-xl",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 ".concat(s?"opacity-50 cursor-not-allowed":""),disabled:s,children:"✕"})}),(0,r.jsxs)("div",{className:"mb-6 ".concat(l?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[(0,r.jsx)("span",{className:"text-4xl",children:s?"⟳":l?"✕":"✓"}),(0,r.jsx)("h2",{className:"text-2xl font-bold mt-2",children:s?(0,r.jsxs)("span",{className:"inline-flex items-center",children:["Workout saving...",(0,r.jsxs)("svg",{className:"animate-spin ml-2 h-5 w-5",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})]}):l?"Failed to save workout. Please try again.":"Workout saved successfully!"}),l&&(0,r.jsx)("p",{className:"text-sm mt-2 text-red-500",children:"Error details have been logged to console"})]}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Recommended Post-Workout Hydration"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,r.jsx)("th",{className:"p-2 text-left text-gray-600 dark:text-gray-300",children:"Exercise Duration"}),(0,r.jsx)("th",{className:"p-2 text-left text-gray-600 dark:text-gray-300",children:"Condition"}),(0,r.jsx)("th",{className:"p-2 text-left text-gray-600 dark:text-gray-300",children:"Fluids (fl. oz)"}),(0,r.jsx)("th",{className:"p-2 text-left text-gray-600 dark:text-gray-300",children:"Table Salt (tsp)"}),(0,r.jsx)("th",{className:"p-2 text-left text-gray-600 dark:text-gray-300",children:"K (bananas)"})]})}),(0,r.jsxs)("tbody",{className:"divide-y dark:divide-gray-700",children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"90 min zone 2"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Outdoors, sunny, 93\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"51"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.75"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.8"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"90 min zone 2"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Indoors, 72\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"38"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.56"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.6"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"45 min zone 2"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Indoors, 72\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"19"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.28"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.3"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"45 min HIIT"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Indoors, 72\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"29"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.43"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.5"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"45 min tempo"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Indoors, 72\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"24"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.35"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.4"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"45 min Norwegian 4x4"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"Indoors, 72\xb0F"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"34"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.50"}),(0,r.jsx)("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:"0.5"})]})]})]})}),(0,r.jsx)("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:"Note: Consume fluids and electrolytes gradually over 2-4 hours post-workout. Bananas are listed as a reference for potassium content."})]})}):null}function y(e){let{isOpen:t,onClose:a,existingWorkout:s,newWorkout:l,onAdd:n,onReplace:o,onEdit:d}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl max-w-2xl w-full m-4 shadow-xl",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Workout Already Exists"}),(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Existing Workout for ",s.workout_date,":"]}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("p",{children:["Strength Volume: ",s.strength_volume," lbs"]}),(0,r.jsxs)("p",{children:["Cardio Load: ",s.cardio_load]}),s.note&&(0,r.jsxs)("p",{className:"italic mt-2",children:["Note: ",s.note]})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Workout Data:"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("p",{children:["Strength Volume: ",l.strength_volume," lbs"]}),(0,r.jsxs)("p",{children:["Cardio Load: ",l.cardio_load]}),l.note&&(0,r.jsxs)("p",{className:"italic mt-2",children:["Note: ",l.note]})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsx)("button",{onClick:n,className:"flex-1 p-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Add to Day's Totals"}),(0,r.jsx)("button",{onClick:o,className:"flex-1 p-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors",children:"Replace Existing"}),(0,r.jsx)("button",{onClick:d,className:"flex-1 p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Edit Existing"}),(0,r.jsx)("button",{onClick:a,className:"flex-1 p-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})}):null}function b(e){let{workouts:t}=e,[a,l]=(0,s.useState)(14),n=(e=>{let t={};return e.slice(0,a).forEach(e=>{let a=new Date(e.workout_date),r=new Date(a);r.setDate(a.getDate()-a.getDay());let s=r.toISOString().split("T")[0];t[s]||(t[s]=[]),t[s].push(e)}),t})(t),o=t.length>a;return(0,r.jsxs)("div",{className:"space-y-6",children:[Object.entries(n).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-3",children:["Week of ",new Date(t).toLocaleDateString()]}),(0,r.jsx)("div",{className:"space-y-2",children:a.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:new Date(e.workout_date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("p",{children:["Strength: ",e.strength_volume," lbs"]}),(0,r.jsxs)("p",{children:["Cardio: ",e.cardio_load]})]})]}),(0,r.jsxs)("div",{className:"text-sm text-right",children:[(0,r.jsxs)("p",{className:"font-medium ".concat(e.strength_ratio<.8?"text-yellow-500":e.strength_ratio>1.4?"text-red-500":"text-green-500"),children:["SR: ",null===(t=e.strength_ratio)||void 0===t?void 0:t.toFixed(2)]}),(0,r.jsxs)("p",{className:"font-medium ".concat(e.cardio_ratio<.8?"text-yellow-500":e.cardio_ratio>1.4?"text-red-500":"text-green-500"),children:["CR: ",null===(a=e.cardio_ratio)||void 0===a?void 0:a.toFixed(2)]})]})]}),e.note&&(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400 italic",children:e.note})]},e.id)})})]},t)}),o&&(0,r.jsx)("button",{onClick:()=>l(e=>e+14),className:"w-full p-3 mt-4 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-sm font-medium",children:"Show More Workouts"})]})}let p=[{id:"sunday",label:"Sun"},{id:"monday",label:"Mon"},{id:"tuesday",label:"Tue"},{id:"wednesday",label:"Wed"},{id:"thursday",label:"Thu"},{id:"friday",label:"Fri"},{id:"saturday",label:"Sat"}];function k(e){let{onSubmit:t,onCancel:a}=e,[l,n]=(0,s.useState)({startDate:new Date().toISOString().split("T")[0],strengthVolume:"",cardioLoad:"",note:"",recurrence:"once",customDays:p.reduce((e,t)=>({...e,[t.id]:!1}),{}),endType:"never",endAfter:1,endDate:""}),o=(e,t)=>{n(a=>({...a,[e]:t}))};return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(l)},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("input",{type:"date",value:l.startDate,onChange:e=>o("startDate",e.target.value),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("input",{type:"number",placeholder:"Strength Volume (lbs)",value:l.strengthVolume,onChange:e=>o("strengthVolume",e.target.value),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("input",{type:"number",placeholder:"Cardio Load",value:l.cardioLoad,onChange:e=>o("cardioLoad",e.target.value),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("textarea",{placeholder:"Notes",value:l.note,onChange:e=>o("note",e.target.value),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white",rows:"3"})]}),(0,r.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["once","daily","weekly","biweekly","custom"].map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>o("recurrence",e),className:"px-3 py-2 rounded ".concat(l.recurrence===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),"custom"===l.recurrence&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>o("customDays",{...l.customDays,[e.id]:!l.customDays[e.id]}),className:"px-3 py-2 rounded ".concat(l.customDays[e.id]?"bg-blue-500 text-white":"bg-gray-100 text-gray-700"),children:e.label},e.id))}),(0,r.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["never","after","on"].map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>o("endType",e),className:"px-3 py-2 rounded ".concat(l.endType===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700"),children:["End ",e]},e))}),"after"===l.endType&&(0,r.jsx)("input",{type:"number",min:"1",value:l.endAfter,onChange:e=>o("endAfter",parseInt(e.target.value)),className:"w-full p-2 border rounded",placeholder:"Number of occurrences"}),"on"===l.endType&&(0,r.jsx)("input",{type:"date",value:l.endDate,onChange:e=>o("endDate",e.target.value),className:"w-full p-2 border rounded"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"Plan Workout"}),(0,r.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-gray-100 text-gray-700 p-2 rounded hover:bg-gray-200",children:"Cancel"})]})]})}async function j(e){let{data:t,error:a}=await l.A.from("planned_workouts").insert([e]).select().single();if(a)throw a;return t}async function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=l.A.from("planned_workouts").select("*").order("start_date",{ascending:!0});e&&(a=a.gte("start_date",e)),t&&(a=a.lte("start_date",t));let{data:r,error:s}=await a;if(s)throw s;return r}function f(e){let{session:t}=e,[a,l]=(0,s.useState)("list"),[o,d]=(0,s.useState)(!1),[i,c]=(0,s.useState)([]),[g,x]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0);async function h(){try{let e=await w(t.user.id);c(e)}catch(e){x("Failed to load planned workouts"),console.error(e)}finally{m(!1)}}(0,s.useEffect)(()=>{h()},[]);let y=async e=>{try{x(null),await j({...e,user_id:t.user.id}),await h(),d(!1)}catch(e){x("Failed to plan workout"),console.error(e)}};return u?(0,r.jsx)("div",{children:"Loading planned workouts..."}):(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Workout Planner"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all",children:"Plan New Workout"}),(0,r.jsx)("button",{onClick:()=>l("list"),className:"px-4 py-2 rounded-lg transition-all ".concat("list"===a?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"List View"}),(0,r.jsx)("button",{onClick:()=>l("calendar"),className:"px-4 py-2 rounded-lg transition-all ".concat("calendar"===a?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"Calendar View"})]})]}),o?(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Plan New Workout"}),(0,r.jsx)("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"✕"})]}),(0,r.jsx)(k,{onSubmit:y})]}):"list"===a?(0,r.jsx)(b,{workouts:i}):(0,r.jsx)("div",{className:"text-gray-600 dark:text-gray-400 text-center p-8",children:"Calendar view coming soon"}),g&&(0,r.jsx)(n,{message:g})]})}function N(){let[e,t]=(0,s.useState)(null),[a,d]=(0,s.useState)(new Date().toISOString().split("T")[0]),[i,c]=(0,s.useState)(""),[u,b]=(0,s.useState)(""),[p,k]=(0,s.useState)(""),[j,w]=(0,s.useState)([]),[N,v]=(0,s.useState)(""),[S,_]=(0,s.useState)(""),[C,D]=(0,s.useState)({strengthRatio:0,cardioRatio:0,combinedRatio:0}),[I,A]=(0,s.useState)({strength:!0,cardio:!0,combined:!0}),[R,F]=(0,s.useState)(!1),[T,W]=(0,s.useState)(!1),[E,O]=(0,s.useState)(null),[L,P]=(0,s.useState)({history:null,marriagePrompt:null,session:null,general:null}),[V,M]=(0,s.useState)(!1),[z,Z]=(0,s.useState)(null),[U,J]=(0,s.useState)(null),[q,H]=(0,s.useState)("tracker");(0,s.useEffect)(()=>{let e=!0;(async function(){try{let{data:{session:a},error:r}=await l.A.auth.getSession();if(r)throw r;e&&t(a)}catch(e){console.error("Session error:",e),P(e=>({...e,session:"Failed to load session. Please sign out and try again."}))}})();let{data:{subscription:a}}=l.A.auth.onAuthStateChange((a,r)=>{e&&t(r)});return()=>{e=!1,a.unsubscribe()}},[]),(0,s.useEffect)(()=>{e&&(G(),Q())},[e]);let G=async()=>{try{let{data:t,error:a}=await l.A.from("workouts").select("*").eq("user_id",e.user.id).order("workout_date",{ascending:!1});if(a)throw a;w(t);let r=t[0];r&&D({strengthRatio:r.strength_ratio||0,cardioRatio:r.cardio_ratio||0,combinedRatio:r.combined_ratio||0}),P(e=>({...e,history:null}))}catch(e){console.error("History fetch error:",e),P(e=>({...e,history:"Failed to load workout history"}))}},X=async t=>{t.preventDefault();let r={workout_date:a,strength_volume:parseInt(i)||0,cardio_load:parseInt(u)||0,note:p,user_id:e.user.id,created_at:new Date().toISOString()},{data:s,error:n}=await l.A.from("workouts").select("*").eq("workout_date",a).eq("user_id",e.user.id);if(n){console.error("Error checking existing workout:",n);return}if(s&&s.length>0){Z(s[0]),J(r),M(!0);return}await B(r)},B=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"new";W(!0),O(null),F(!0);let s=Date.now();try{let a;let n={workout_date:t.workout_date,strength_volume:parseInt(t.strength_volume)||0,cardio_load:parseInt(t.cardio_load)||0,note:t.note||"",user_id:e.user.id};if("add"===r){let e={...n,strength_volume:(z.strength_volume||0)+(n.strength_volume||0),cardio_load:(z.cardio_load||0)+(n.cardio_load||0),note:n.note?"".concat(z.note||"","\n").concat(n.note):z.note,updated_at:new Date().toISOString()};console.log("Adding to existing workout:",{combinedData:e,existingId:z.id}),a=await l.A.from("workouts").update(e).eq("id",z.id).select("*").single()}else"replace"===r?(console.log("Replacing workout:",{baseData:n,existingId:z.id}),a=await l.A.from("workouts").update(n).eq("id",z.id).select("*").single()):(console.log("Creating new workout:",n),a=await l.A.from("workouts").insert([n]).select("*").single());if(a.error)throw console.error("Database operation failed:",{mode:r,error:a.error,data:n,result:a}),Error("Failed to ".concat(r," workout: ").concat(a.error.message));console.log("Operation successful:",{mode:r,result:a.data});let o=Date.now()-s,i=Math.max(2e3-o,0);await new Promise(e=>setTimeout(e,i)),await G(),d(new Date().toISOString().split("T")[0]),c(""),b(""),k("")}catch(e){console.error("Failed to save workout:",{error:e,mode:r,workoutDate:a,strength:i,cardio:u}),O(e)}finally{W(!1),M(!1),Z(null),J(null)}},Q=async()=>{console.log("Debugging marriage prompts table...");try{let{data:e,error:t}=await l.A.from("marriage_prompts").select("*");if(console.log("Query response:",{hasError:!!t,errorDetails:t,dataLength:null==e?void 0:e.length,rawData:e}),t)throw t;if(e&&e.length>0){let t=new Date().toISOString().split("T")[0];console.log("Looking for date:",t);let a=e.find(e=>e.date===t),r=e.sort((e,t)=>new Date(t.date)-new Date(e.date)),s=a||r[0];s?(console.log("Selected prompt:",s),v(s.prompt)):v("No prompt available")}else console.log("No prompts found in database"),v("No prompts available")}catch(e){console.error("Error details:",{message:e.message,hint:e.hint,details:e.details,code:e.code}),v("Unable to load prompt")}},Y=e=>{A(t=>({...t,[e]:!t[e]}))},$=(e,t)=>{let a=e.target.value;/^\d*$/.test(a)&&t(a)};if(!e)return(0,r.jsx)(o,{});let K=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[L.session&&(0,r.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,r.jsx)(n,{message:L.session})}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Focus Tracker"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:K})]}),(0,r.jsx)("button",{onClick:()=>l.A.auth.signOut(),className:"px-4 py-2 bg-red-500 text-white rounded-lg transition-all hover:bg-red-600 active:scale-95",children:"Sign Out"})]}),(0,r.jsxs)("div",{className:"flex space-x-2 mb-6",children:[(0,r.jsx)("button",{onClick:()=>H("tracker"),className:"px-4 py-2 rounded-lg transition-all ".concat("tracker"===q?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"Workout Tracker"}),(0,r.jsx)("button",{onClick:()=>H("planner"),className:"px-4 py-2 rounded-lg transition-all ".concat("planner"===q?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"Workout Planner"})]}),"tracker"===q?(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-blue-100 dark:border-blue-900/30",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Daily Marriage Focus"}),L.marriagePrompt?(0,r.jsx)(n,{message:L.marriagePrompt}):(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 italic bg-blue-50 dark:bg-blue-900/10 p-4 rounded-lg border border-blue-100 dark:border-blue-900/30",children:N||"Loading..."})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Add Workout"}),(0,r.jsxs)("form",{onSubmit:X,className:"space-y-4",children:[(0,r.jsx)("input",{type:"date",value:a,onChange:e=>d(e.target.value),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"}),(0,r.jsx)("input",{type:"text",inputMode:"numeric",pattern:"\\d*",placeholder:"Strength Volume (lbs)",value:i,onChange:e=>$(e,c),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"}),(0,r.jsx)("input",{type:"text",inputMode:"numeric",pattern:"\\d*",placeholder:"Cardio Load",value:u,onChange:e=>$(e,b),className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"}),(0,r.jsx)("textarea",{placeholder:"Workout Notes",value:p,onChange:e=>k(e.target.value),rows:"3",className:"w-full p-3 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"}),(0,r.jsx)("button",{type:"submit",className:"w-full p-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 active:scale-95 transition-all font-medium",children:"Save Workout"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[L.history&&(0,r.jsx)(n,{message:L.history}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[(0,r.jsx)(m,{}),(0,r.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,r.jsx)(x,{label:"Strength",value:C.strengthRatio,isVisible:I.strength,color:"bg-blue-500",onClick:()=>Y("strength")}),(0,r.jsx)(x,{label:"Cardio",value:C.cardioRatio,isVisible:I.cardio,color:"bg-orange-500",onClick:()=>Y("cardio")}),(0,r.jsx)(x,{label:"Combined",value:C.combinedRatio,isVisible:I.combined,color:"bg-green-500",onClick:()=>Y("combined")})]}),(0,r.jsx)(g,{data:j.slice(0,14).reverse(),visibleLines:I})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Recent History"}),(0,r.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:j.map(e=>(0,r.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:[e.workout_date," - Week ",e.training_cycle_week]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Goal: ",e.training_cycle_goal]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Strength: ",e.strength_volume," lbs",(0,r.jsx)("span",{className:"mx-2",children:"•"}),"Cardio: ",e.cardio_load]}),e.note&&(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 italic",children:e.note})]},e.id))})]})]})]}):(0,r.jsx)(f,{history:j})]})]}),(0,r.jsx)(y,{isOpen:V,onClose:()=>M(!1),existingWorkout:z,newWorkout:U,onAdd:()=>B(U,"add"),onReplace:()=>B(U,"replace"),onEdit:()=>{d(z.workout_date),c(z.strength_volume.toString()),b(z.cardio_load.toString()),k(z.note||""),M(!1)}}),(0,r.jsx)(h,{isOpen:R,onClose:()=>{F(!1),O(null)},isSaving:T,error:E})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,736,985,441,517,358],()=>t(3157)),_N_E=e.O()}]);